(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[264],{6653:function(e,t,r){"use strict";r.d(t,{L:function(){return o},c:function(){return i}});var n=r(5474),a=r(666);function o(){return localStorage.getItem(a.px)}async function s(){return await (0,n.gw)(2e3),{code:a.mI,message:"Mock",data:{nickName:"Mock",token:"Mock"}}}async function i(e,t){if(a.M7)return await s();let r=await fetch("".concat(a.FH,"/member/login"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:e,password:t})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return await r.json()}},7454:function(e,t,r){"use strict";var n=r(9268),a=r(6394),o=r.n(a),s=r(6006),i=r(7613),c=r.n(i);let l=(0,s.memo)((0,s.forwardRef)((e,t)=>{let{src:r,...a}=e;return(0,n.jsx)(o(),{...a,ref:t,unoptimized:!0,src:"string"==typeof r&&r.startsWith("/")&&c().basePath?"".concat(c().basePath).concat(r):r})}));l.displayName="CustomImage",t.Z=l},6831:function(e,t,r){"use strict";var n=r(9268),a=r(6006),o=r(3368),s=r(1576),i=r.n(s),c=r(8683),l=r.n(c),u=r(9153);let d=(0,a.memo)(e=>{let{className:t,children:r,type:a,loading:s,disabled:c,onClick:d,looks:m,icon:f,...p}=e;return(0,n.jsxs)("button",{...p,className:"close"===f?l()("h-8 w-8 bg-close bg-4 bg-center bg-no-repeat opacity-50 hover:opacity-75",t):l()("rounded px-3 py-1.5",{[i().primary]:!m||m===u.L.primary,[i().danger]:m===u.L.danger,[i().dark]:m===u.L.dark,"bg-green-700 text-white":m===u.L.green},t),disabled:s||c,onClick:d,type:a,children:[s&&(0,n.jsx)(o.Z,{size:o.v.small})," ",r]})});d.displayName="Button",t.Z=d},1263:function(e,t,r){"use strict";var n=r(9268),a=r(6006),o=r(8683),s=r.n(o);let i=(0,a.memo)((0,a.forwardRef)((e,t)=>{let{className:r,type:a,value:o,onChange:i,onKeyDown:c,disabled:l,placeholder:u}=e;return(0,n.jsx)("input",{className:s()("rounded border border-solid border-gray-300 p-1",r),type:a,value:o,onChange:e=>{let t=e.target.value;null==i||i(t)},onKeyDown:c,disabled:l,placeholder:u,ref:t})}));t.Z=i},7007:function(e,t,r){"use strict";var n=r(9268),a=r(6006),o=r(8431),s=r(4209),i=r.n(s),c=r(6831),l=r(8683),u=r.n(l),d=r(6292);function m(e){let{title:t,children:r,footer:a,width:o,isCloseButtonShow:s,maskClosable:l,onClose:d}=e;return(0,n.jsx)("div",{className:u()(i().backgroundMask,"z-[1500]"),onClick:l?d:void 0,children:(0,n.jsxs)("div",{className:"my-12 divide-y divide-solid rounded bg-white",style:{width:o},onClick:e=>{e.stopPropagation()},children:[t&&(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 text-xl font-medium",children:[t,s&&(0,n.jsx)(c.Z,{className:"p-2",icon:"close",onClick:d})]}),r&&(0,n.jsx)("div",{className:"p-4",children:r}),a&&(0,n.jsx)("div",{className:"p-4",children:a})]})})}let f=(0,a.memo)(e=>{let{title:t,children:r,footer:a,open:s=!1,width:i,isCloseButtonShow:c,maskClosable:l=!0,onClose:u}=e;return s&&(0,o.createPortal)((0,n.jsx)(m,{title:t,footer:a,width:i,isCloseButtonShow:c,maskClosable:l,onClose:u,children:r}),document.body)});f.displayName="Modal";let p=(0,a.memo)(e=>{let{content:t,onOk:r,okButtonProps:o,onCancel:s,cancelButtonProps:l}=e,[u,d]=(0,a.useState)(!1),[f,p]=(0,a.useState)(!1),h=(0,a.useCallback)(async()=>{d(!0),await (null==r?void 0:r()),d(!1)},[r]),g=(0,a.useCallback)(async()=>{p(!0),await (null==s?void 0:s()),p(!1)},[s]);return(0,n.jsxs)(m,{children:[t,(0,n.jsxs)("div",{className:i().buttonGroup,children:[(0,n.jsx)(c.Z,{...o,loading:u,disabled:f,onClick:h,children:"確定"}),(0,n.jsx)(c.Z,{...l,loading:f,disabled:u,onClick:g,children:"取消"})]})]})});p.displayName="ConfirmModal",f.confirm=e=>{let{content:t,onOk:r,okButtonProps:a,onCancel:o,cancelButtonProps:s}=e,i=(0,d.E)("confirmModal"),{render:c,removeModal:l}=(0,d.k)(i);c((0,n.jsx)(p,{content:t,onOk:async()=>{try{await (null==r?void 0:r()),l()}catch(e){}},okButtonProps:a,onCancel:async()=>{await (null==o?void 0:o()),l()},cancelButtonProps:s}))},t.Z=f},3368:function(e,t,r){"use strict";r.d(t,{v:function(){return a}});var n,a,o=r(9268),s=r(6006),i=r(8683),c=r.n(i);(n=a||(a={})).small="small",n.medium="medium";let l=(0,s.memo)(e=>{let{spinning:t=!0,size:r=a.medium,expand:n=!1,children:s}=e;return(0,o.jsxs)("div",{className:c()("relative inline-block",{"h-full w-full":n}),children:[s,t&&(0,o.jsx)("div",{className:c()("inset-0 flex items-center justify-center",{"absolute bg-white opacity-70":s,"static bg-transparent":!s}),children:(0,o.jsx)("div",{className:c()("animate-spin rounded-full border-solid border-slate-100 border-t-blue-500",{"h-2.5 w-2.5 border-2":r===a.small,"h-10 w-10 border-4":r===a.medium})})})]})});l.displayName="Spin",t.Z=l},8302:function(e,t,r){"use strict";var n=r(9268),a=r(6006),o=r(6462),s=r(3368),i=r(8683),c=r.n(i);let l=(0,a.memo)(e=>{let{className:t,rowKeyName:r="id",columns:i=[],dataSource:l=[],loading:u=!1}=e,d=(0,a.useMemo)(()=>i.map(e=>[e.dataIndex||(0,o.Z)(),e]),[i]),m=(0,a.useMemo)(()=>(0,n.jsx)("tr",{children:d.map(e=>{let[t,{title:r}]=e;return(0,n.jsx)("th",{className:"border-b border-solid border-gray-800 p-2 text-start",children:r},t)})}),[d]),f=(0,a.useMemo)(()=>l.map(e=>(0,n.jsx)("tr",{className:"even:bg-black/5",children:d.map(t=>{let[r,{dataIndex:a,render:o}]=t;return(0,n.jsx)("td",{className:"border-b border-solid border-gray-300 p-2",children:o?o(a&&e[a],e):a&&e[a]},r)})},e[r])),[d,l,r]);return(0,n.jsx)(s.Z,{spinning:u,expand:!0,children:(0,n.jsx)("div",{className:c()("overflow-auto",t),children:(0,n.jsx)("table",{className:"w-full border-collapse",children:(0,n.jsxs)("tbody",{children:[m,f]})})})})});l.displayName="Table",t.Z=l},1897:function(e,t,r){"use strict";var n=r(9268),a=r(8683),o=r.n(a),s=r(6006);let i=(0,s.memo)((0,s.forwardRef)((e,t)=>{let{className:r,value:a,onChange:s}=e;return(0,n.jsx)("textarea",{className:o()("rounded border border-solid border-gray-300 p-1",r),value:a,onChange:e=>{null==s||s(e.target.value)},ref:t})}));t.Z=i},158:function(e,t,r){"use strict";var n=r(9268),a=r(6006),o=r(6292),s=r(8683),i=r.n(s);let c=(0,a.memo)(e=>{let{children:t,icon:r,removeModal:o}=e,[s,c]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=setTimeout(()=>{c(!1),e=setTimeout(()=>{o()},300)},3e3);return()=>{clearTimeout(e)}},[o]),(0,n.jsxs)("div",{className:i()("my-2 rounded bg-white px-4 py-2 shadow",{"animate-fade-in":s,"animate-fade-out":!s}),children:[r," ",t]})});function l(e,t){let r=(0,o.E)("toastContainer","fixed left-1/2 top-0 z-[2000] -translate-x-1/2 transform"),{render:a,removeModal:s}=(0,o.k)(r);a((0,n.jsx)(c,{icon:t,removeModal:s,children:e}))}c.displayName="Toast",t.Z={success:e=>{l(e,"success:")},error:e=>{l(e,"error:")}}},315:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(9268),a=r(6006),o=r(7454),s=r(1904),i=r(3368),c=r(5503),l=r(5474),u=r(666),d=r(6653);async function m(){return await (0,l.gw)(2e3),{code:u.mI,message:"Mock",data:"/images/mock/朝日夫婦.jpeg"}}async function f(e){if(u.M7)return await m();let t=new FormData;t.append("file",e);let r=await fetch("".concat(u.FH,"/file/upload/image"),{method:"POST",mode:"cors",headers:{Authorization:"Bearer ".concat((0,d.L)())},body:t});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return await r.json()}async function p(){return await (0,l.gw)(2e3),{code:u.mI,message:"Mock",data:"/videos/mock/朝日夫婦.mp4"}}async function h(e){if(u.M7)return await p();let t=new FormData;t.append("file",e);let r=await fetch("".concat(u.FH,"/file/upload/video"),{method:"POST",mode:"cors",headers:{Authorization:"Bearer ".concat((0,d.L)())},body:t});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return await r.json()}async function g(){return await (0,l.gw)(2e3),{code:u.mI,message:"Mock",data:"/panoramas/mock/朝日夫婦.jpeg"}}async function b(e){if(u.M7)return await g();let t=new FormData;t.append("file",e);let r=await fetch("".concat(u.FH,"/file/upload/panorama"),{method:"POST",mode:"cors",headers:{Authorization:"Bearer ".concat((0,d.L)())},body:t});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return await r.json()}var w=r(158);let y=(0,a.memo)(e=>{let{className:t,accept:r,fileType:l,value:d,onChange:m}=e,{data:p,loading:g,run:y}=(0,s.Q)(async e=>{switch(l){case c.p.IMAGE:{let t=await f(e);if(t.code===u.mI)return w.Z.success("成功"),null==m||m(t.data),t.data;w.Z.error(t.message);break}case c.p.VIDEO:{let t=await h(e);if(t.code===u.mI)return w.Z.success("成功"),null==m||m(t.data),t.data;w.Z.error(t.message);break}case c.p.PANORAMA:{let t=await b(e);if(t.code===u.mI)return w.Z.success("成功"),null==m||m(t.data),t.data;w.Z.error(t.message)}}}),v=(0,a.useRef)(null);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("input",{className:"hidden",type:"file",accept:r,ref:v,onChange:async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];r&&await y(r)}}),(0,n.jsx)(i.Z,{spinning:g,children:(0,n.jsx)(o.Z,{className:"h-24 w-24 cursor-pointer object-cover",src:d||p||"/images/mock/add-image.png",width:100,height:100,alt:"add",onClick:()=>{v.current.click()}})})]})});y.displayName="Upload";var v=y},6292:function(e,t,r){"use strict";r.d(t,{E:function(){return a},k:function(){return o}});var n=r(3194);function a(e,t){let r=document.getElementById(e);return r||((r=document.createElement("div")).id=e,t&&(r.className=t),document.body.appendChild(r)),r}function o(e){let t=document.createElement("div");e.appendChild(t);let r=(0,n.createRoot)(t);return{render:e=>{r.render(e)},removeModal:()=>{r.unmount(),null==e||e.removeChild(t)}}}},1904:function(e,t,r){"use strict";r.d(t,{Q:function(){return o}});var n=r(6006),a=r(6462);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{manual:!0},r=(0,n.useRef)(t.manual),[o,s]=(0,n.useState)({loading:!1,data:void 0}),i=(0,n.useRef)(),c=(0,n.useRef)(!1),l=(0,n.useRef)(),u=(0,n.useCallback)(async function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];let o=(0,a.Z)();i.current=o,c.current=!0,l.current=r,s(e=>{let{data:t}=e;return{loading:!0,data:t}});let u=await e(...r);if(o!==i.current)throw Error("canceled");return s({loading:!1,data:u}),u},[e]),d=(0,n.useRef)(u),m=(0,n.useCallback)(async()=>{if(c.current)return await u(...l.current);throw Error("Run should be called first")},[u]),f=(0,n.useCallback)(()=>{let e=(0,a.Z)();i.current=e,s({loading:!1,data:void 0})},[]);return(0,n.useEffect)(()=>{r.current||d.current(...[])},[]),(0,n.useMemo)(()=>({run:u,refresh:m,reset:f,...o}),[u,m,f,o])}},7613:function(e){"use strict";e.exports={output:"export",basePath:"/historic-site-portal-demo-test"}},2624:function(e,t,r){"use strict";var n,a;r.d(t,{L:function(){return n}}),(a=n||(n={})).none="none",a.console="console",a.message="message"},9153:function(e,t,r){"use strict";var n,a;r.d(t,{L:function(){return n}}),(a=n||(n={})).primary="primary",a.dark="dark",a.danger="danger",a.green="green"},5503:function(e,t,r){"use strict";var n,a;r.d(t,{p:function(){return n}}),(a=n||(n={}))[a.VIDEO=0]="VIDEO",a[a.PANORAMA=1]="PANORAMA",a[a.IMAGE=2]="IMAGE"},666:function(e,t,r){"use strict";r.d(t,{FH:function(){return n},M7:function(){return o},mI:function(){return s},px:function(){return a}});let n="https://historical-site-backend-18d1df54380f.herokuapp.com",a="token",o=!1,s="S001"},5474:function(e,t,r){"use strict";r.d(t,{cM:function(){return i},gw:function(){return s},rn:function(){return c},sG:function(){return l}});var n=r(2624),a=r(5326),o=r.n(a);let s=async e=>{await new Promise(t=>setTimeout(t,e))},i=(e,t)=>{switch(t){case n.L.none:break;case n.L.console:case n.L.message:console.log(e)}};function c(e){return e?o()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}let l=(async()=>{}).constructor},1576:function(e){e.exports={primary:"Button_primary__Nhi6i",danger:"Button_danger__214td",dark:"Button_dark__Djc0e"}},4209:function(e){e.exports={backgroundMask:"Modal_backgroundMask__9WqVi",buttonGroup:"Modal_buttonGroup__PS_fc"}}}]);