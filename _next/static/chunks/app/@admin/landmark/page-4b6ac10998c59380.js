(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[103],{7270:function(e,t,a){Promise.resolve().then(a.bind(a,1019))},6653:function(e,t,a){"use strict";a.d(t,{L:function(){return s},c:function(){return c}});var n=a(5474),r=a(666);function s(){return localStorage.getItem(r.px)}async function o(){return await (0,n.gw)(2e3),{code:r.mI,message:"Mock",data:{nickName:"Mock",token:"Mock"}}}async function c(e,t){if(r.M7)return await o();let a=await fetch("".concat(r.FH,"/member/login"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:e,password:t})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return await a.json()}},1019:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var n=a(9268),r=a(8302),s=a(1904),o=a(6006),c=a(2313),l=a(1263),i=a(6831),d=a(9153),u=a(5474),m=a(666),h=a(6653);async function f(){return await (0,u.gw)(2e3),{code:m.mI,message:"Mock",data:[{caseId:"1",caseName:"林家花園",coordinate:"24.06109876319344, 120.70354094928975",address:"413台中市霧峰區萊園路91號",describe:"設伝夫求釜燃景軍業論情再馬実。軽武以",coverImgURL:"/images/mock/林家花園.jpeg",operator:"admin01",operatorTime:"2023-06-19 23:30:45"}]}}async function p(){if(m.M7)return await f();let e=await fetch("".concat(m.FH,"/management/sites"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,h.L)())}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}async function b(){return await (0,u.gw)(2e3),{code:m.mI,message:"Mock",data:{caseId:"1",caseName:"林家花園",coordinate:"24.06109876319344, 120.70354094928975",address:"413台中市霧峰區萊園路91號",describe:"設伝夫求釜燃景軍業論情再馬実。軽武以",coverImgURL:"/images/mock/林家花園.jpeg",operator:"admin01",operatorTime:"2023-06-19 23:30:45"}}}async function g(e){if(m.M7)return await b();let t=await fetch("".concat(m.FH,"/management/sites/").concat(e),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,h.L)())}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}async function x(){return await (0,u.gw)(2e3),{code:m.mI,message:"mock"}}async function j(e){if(m.M7)return await x();let t=await fetch("".concat(m.FH,"/management/sites/").concat(e),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,h.L)())}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}var k=a(7454),v=a(7007),w=a(3368),y=a(1897);async function N(e){try{let t=await g(e);if((null==t?void 0:t.code)!==m.mI)return;return t.data}catch(e){}}async function C(e){}let Z=(0,o.memo)(e=>{let{open:t,caseId:a,onClose:r}=e,u=(0,o.useRef)(),{run:m,reset:h,loading:f}=(0,s.Q)(N);(0,o.useEffect)(()=>{let e=!1;return(async()=>{if(t&&a){var n,r;let t=await m(a);!e&&t?null===(n=u.current)||void 0===n||n.initialize(t):(h(),null===(r=u.current)||void 0===r||r.reset())}})(),()=>{e=!0}},[a,t,h,m]);let{run:p}=(0,s.Q)(C);return(0,n.jsx)(v.Z,{open:t,title:"古蹟資訊",footer:(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(i.Z,{looks:d.L.dark,children:"保存"})}),width:554,isCloseButtonShow:!0,onClose:r,maskClosable:!1,children:(0,n.jsx)(w.Z,{expand:!0,spinning:f,children:(0,n.jsx)(c.l0,{onSubmit:p,render:e=>{let{form:t,handleSubmit:a,values:r}=e;return console.log(r),u.current=t,(0,n.jsxs)("form",{onSubmit:a,children:[(0,n.jsxs)("div",{className:"m-2",children:[(0,n.jsx)("label",{className:"mb-2 block",children:"古蹟名稱"}),(0,n.jsx)(c.gN,{name:"caseName",render:e=>{let{input:{value:t,onChange:a}}=e;return(0,n.jsx)(l.Z,{className:"block w-full text-sm",value:t,onChange:a})}})]}),(0,n.jsxs)("div",{className:"m-2",children:[(0,n.jsx)("label",{className:"mb-2 block",children:"座標位置"}),(0,n.jsx)(c.gN,{name:"TODO:",render:e=>{let{input:{value:t,onChange:a}}=e;return(0,n.jsx)(l.Z,{className:"block w-full text-sm",value:t,onChange:a,placeholder:"請輸入古蹟座標位置(google map中右鍵可複製)"})}})]}),(0,n.jsxs)("div",{className:"m-2",children:[(0,n.jsx)("label",{className:"mb-2 block",children:"古蹟地址"}),(0,n.jsx)(c.gN,{name:"TODO:",render:e=>{let{input:{value:t,onChange:a}}=e;return(0,n.jsx)(l.Z,{className:"block w-full text-sm",value:t,onChange:a})}})]}),(0,n.jsxs)("div",{className:"m-2",children:[(0,n.jsx)("label",{className:"mb-2 block",children:"古蹟描述"}),(0,n.jsx)(c.gN,{name:"TODO:",render:e=>{let{input:{value:t,onChange:a}}=e;return(0,n.jsx)(y.Z,{className:"block w-full text-sm",value:t,onChange:a})}})]}),(0,n.jsxs)("div",{className:"m-2",children:[(0,n.jsx)("label",{className:"mb-2 block",children:"新增圖片"}),(0,n.jsx)(k.Z,{className:"h-24 w-24 object-cover",src:"/images/mock/add-image.png",width:100,height:100,alt:"add"})]}),(0,n.jsxs)("div",{className:"m-2",children:[(0,n.jsx)("label",{className:"mb-2 block",children:"新增影片"}),(0,n.jsx)(k.Z,{className:"h-24 w-24 object-cover",src:"/images/mock/add-image.png",width:100,height:100,alt:"add"})]}),(0,n.jsxs)("div",{className:"m-2",children:[(0,n.jsx)("label",{className:"mb-2 block",children:"環景照片"}),(0,n.jsx)(k.Z,{className:"h-24 w-24 object-cover",src:"/images/mock/add-image.png",width:100,height:100,alt:"add"})]})]})}})})})});async function M(e){console.log(e);try{let e=await p();if((null==e?void 0:e.code)!==m.mI)return[];return e.data}catch(e){return[]}}Z.displayName="EditModal";let I=(0,o.memo)(()=>{let{run:e,refresh:t,data:a,loading:u}=(0,s.Q)(M,{manual:!1}),{openModal:m,editModalProps:h}=function(){let[e,t]=(0,o.useState)({open:!1}),a=(0,o.useCallback)(e=>{t({caseId:e,open:!0})},[]),n=(0,o.useCallback)(()=>{t({open:!1})},[]);return(0,o.useMemo)(()=>({openModal:a,editModalProps:{...e,onClose:n}}),[a,e,n])}(),f=(0,o.useMemo)(()=>[{title:"ID",dataIndex:"caseId"},{title:"古蹟名稱",dataIndex:"caseName"},{title:"座標位置",dataIndex:"coordinate"},{title:"古蹟地址",dataIndex:"address"},{title:"古蹟描述",dataIndex:"describe"},{title:"封面照",dataIndex:"coverImgURL",render:e=>(0,n.jsx)(k.Z,{className:"h-24 w-24 min-w-24 object-cover",src:e,width:100,height:100,alt:"封面照"})},{title:"操作者",dataIndex:"operator"},{title:"操作時間",dataIndex:"operatorTime"},{title:"操作",render:(e,a)=>(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(i.Z,{looks:d.L.green,onClick:()=>{m(a.caseId)},children:"編輯"}),(0,n.jsx)(i.Z,{looks:d.L.danger,onClick:()=>{v.Z.confirm({content:(0,n.jsx)("p",{children:"是否確認刪除？"}),onOk:async()=>{await j(a.caseId),t()},okButtonProps:{looks:d.L.danger}})},children:"刪除"})]})}],[m,t]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(c.l0,{onSubmit:e,render:e=>{let{handleSubmit:t}=e;return(0,n.jsx)("form",{onSubmit:t,children:(0,n.jsx)(c.gN,{name:"idOrName",render:e=>{let{input:{value:t,onChange:a}}=e;return(0,n.jsx)(l.Z,{value:t,onChange:a,placeholder:"請輸入古蹟名稱或ID"})}})})}}),(0,n.jsx)(i.Z,{looks:d.L.dark,onClick:()=>{m()},children:"新增古蹟"})]}),(0,n.jsx)(r.Z,{className:"mt-6",columns:f,dataSource:a,loading:u}),(0,n.jsx)(Z,{...h})]})});I.displayName="LandMarkPage";var T=I},7454:function(e,t,a){"use strict";var n=a(9268),r=a(6394),s=a.n(r),o=a(6006),c=a(7613),l=a.n(c);let i=(0,o.memo)((0,o.forwardRef)((e,t)=>{let{src:a,...r}=e;return(0,n.jsx)(s(),{...r,ref:t,unoptimized:!0,src:"string"==typeof a&&a.startsWith("/")&&l().basePath?"".concat(l().basePath).concat(a):a})}));i.displayName="CustomImage",t.Z=i},6831:function(e,t,a){"use strict";var n=a(9268),r=a(6006),s=a(3368),o=a(1576),c=a.n(o),l=a(8683),i=a.n(l),d=a(9153);let u=(0,r.memo)(e=>{let{className:t,children:a,loading:r,disabled:o,htmlType:l,onClick:u,looks:m,icon:h}=e;return(0,n.jsxs)("button",{className:"close"===h?i()("h-8 w-8 bg-close bg-4 bg-center bg-no-repeat opacity-50 hover:opacity-75",t):i()("rounded px-3 py-1.5",{[c().primary]:!m||m===d.L.primary,[c().danger]:m===d.L.danger,[c().dark]:m===d.L.dark,"bg-green-700 text-white":m===d.L.green},t),disabled:r||o,onClick:u,type:l,children:[r&&(0,n.jsx)(s.Z,{size:s.v.small})," ",a]})});u.displayName="Button",t.Z=u},1263:function(e,t,a){"use strict";var n=a(9268),r=a(6006),s=a(8683),o=a.n(s);let c=(0,r.memo)((0,r.forwardRef)((e,t)=>{let{className:a,type:r,value:s,onChange:c,onKeyDown:l,disabled:i,placeholder:d}=e;return(0,n.jsx)("input",{className:o()("rounded border border-solid border-gray-300 p-1",a),type:r,value:s,onChange:e=>{let t=e.target.value;null==c||c(t)},onKeyDown:l,disabled:i,placeholder:d,ref:t})}));t.Z=c},7007:function(e,t,a){"use strict";var n=a(9268),r=a(6006),s=a(8431),o=a(3194),c=a(4209),l=a.n(c),i=a(6831),d=a(8683),u=a.n(d);function m(e){let{title:t,children:a,footer:r,width:s,isCloseButtonShow:o,maskClosable:c,onClose:d}=e;return(0,n.jsx)("div",{className:u()(l().backgroundMask,"z-[1500]"),onClick:c?d:void 0,children:(0,n.jsxs)("div",{className:"my-12 divide-y divide-solid rounded bg-white",style:{width:s},onClick:e=>{e.stopPropagation()},children:[t&&(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 text-xl font-medium",children:[t,o&&(0,n.jsx)(i.Z,{className:"p-2",icon:"close",onClick:d})]}),a&&(0,n.jsx)("div",{className:"p-4",children:a}),r&&(0,n.jsx)("div",{className:"p-4",children:r})]})})}let h=(0,r.memo)(e=>{let{title:t,children:a,footer:r,open:o=!1,width:c,isCloseButtonShow:l,maskClosable:i=!0,onClose:d}=e;return o&&(0,s.createPortal)((0,n.jsx)(m,{title:t,footer:r,width:c,isCloseButtonShow:l,maskClosable:i,onClose:d,children:a}),document.body)});h.displayName="Modal";let f=(0,r.memo)(e=>{let{content:t,onOk:a,okButtonProps:s,onCancel:o,cancelButtonProps:c}=e,[d,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),p=(0,r.useCallback)(async()=>{u(!0),await (null==a?void 0:a()),u(!1)},[a]),b=(0,r.useCallback)(async()=>{f(!0),await (null==o?void 0:o()),f(!1)},[o]);return(0,n.jsxs)(m,{children:[t,(0,n.jsxs)("div",{className:l().buttonGroup,children:[(0,n.jsx)(i.Z,{...s,loading:d,disabled:h,onClick:p,children:"確定"}),(0,n.jsx)(i.Z,{...c,loading:h,disabled:d,onClick:b,children:"取消"})]})]})});f.displayName="ConfirmModal";let p="confirmModal";h.confirm=e=>{let{content:t,onOk:a,okButtonProps:r,onCancel:s,cancelButtonProps:c}=e,l=document.getElementById(p);l||((l=document.createElement("div")).id=p),document.body.appendChild(l);let i=(0,o.createRoot)(l);i.render((0,n.jsx)(f,{content:t,onOk:async()=>{try{await (null==a?void 0:a()),i.unmount()}catch(e){}},okButtonProps:r,onCancel:async()=>{await (null==s?void 0:s()),i.unmount()},cancelButtonProps:c}))},t.Z=h},3368:function(e,t,a){"use strict";a.d(t,{v:function(){return r}});var n,r,s=a(9268),o=a(6006),c=a(8683),l=a.n(c);(n=r||(r={})).small="small",n.medium="medium";let i=(0,o.memo)(e=>{let{spinning:t=!0,size:a=r.medium,expand:n=!1,children:o}=e;return(0,s.jsxs)("div",{className:l()("relative inline-block",{"h-full w-full":n}),children:[o,t&&(0,s.jsx)("div",{className:l()("inset-0 flex items-center justify-center",{"absolute bg-white opacity-70":o,"static bg-transparent":!o}),children:(0,s.jsx)("div",{className:l()("animate-spin rounded-full border-solid border-slate-100 border-t-blue-500",{"h-2.5 w-2.5 border-2":a===r.small,"h-10 w-10 border-4":a===r.medium})})})]})});i.displayName="Spin",t.Z=i},8302:function(e,t,a){"use strict";var n=a(9268),r=a(6006),s=a(6462),o=a(3368),c=a(8683),l=a.n(c);let i=(0,r.memo)(e=>{let{className:t,rowKeyName:a="id",columns:c=[],dataSource:i=[],loading:d=!1}=e,u=(0,r.useMemo)(()=>c.map(e=>[e.dataIndex||(0,s.Z)(),e]),[c]),m=(0,r.useMemo)(()=>(0,n.jsx)("tr",{children:u.map(e=>{let[t,{title:a}]=e;return(0,n.jsx)("th",{className:"border-b border-solid border-gray-800 p-2 text-start",children:a},t)})}),[u]),h=(0,r.useMemo)(()=>i.map(e=>(0,n.jsx)("tr",{className:"even:bg-black/5",children:u.map(t=>{let[a,{dataIndex:r,render:s}]=t;return(0,n.jsx)("td",{className:"border-b border-solid border-gray-300 p-2",children:s?s(r&&e[r],e):r&&e[r]},a)})},e[a])),[u,i,a]);return(0,n.jsx)(o.Z,{spinning:d,expand:!0,children:(0,n.jsx)("div",{className:l()("overflow-auto",t),children:(0,n.jsx)("table",{className:"w-full border-collapse",children:(0,n.jsxs)("tbody",{children:[m,h]})})})})});i.displayName="Table",t.Z=i},1897:function(e,t,a){"use strict";var n=a(9268),r=a(8683),s=a.n(r),o=a(6006);let c=(0,o.memo)((0,o.forwardRef)((e,t)=>{let{className:a,value:r,onChange:o}=e;return(0,n.jsx)("textarea",{className:s()("rounded border border-solid border-gray-300 p-1",a),value:r,onChange:e=>{null==o||o(e.target.value)},ref:t})}));t.Z=c},1904:function(e,t,a){"use strict";a.d(t,{Q:function(){return s}});var n=a(6006),r=a(6462);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{manual:!0},a=(0,n.useRef)(t.manual),[s,o]=(0,n.useState)({loading:!1,data:void 0}),c=(0,n.useRef)(),l=(0,n.useRef)(!1),i=(0,n.useRef)(),d=(0,n.useCallback)(async function(){for(var t=arguments.length,a=Array(t),n=0;n<t;n++)a[n]=arguments[n];let s=(0,r.Z)();c.current=s,l.current=!0,i.current=a,o(e=>{let{data:t}=e;return{loading:!0,data:t}});let d=await e(...a);if(s!==c.current)throw Error("canceled");return o({loading:!1,data:d}),d},[e]),u=(0,n.useRef)(d),m=(0,n.useCallback)(async()=>{if(l.current)return await d(...i.current);throw Error("Run should be called first")},[d]),h=(0,n.useCallback)(()=>{let e=(0,r.Z)();c.current=e,o({loading:!1,data:void 0})},[]);return(0,n.useEffect)(()=>{a.current||u.current(...[])},[]),(0,n.useMemo)(()=>({run:d,refresh:m,reset:h,...s}),[d,m,h,s])}},7613:function(e){"use strict";e.exports={output:"export",basePath:"/historic-site-portal-demo",basePath:"/historic-site-portal-demo-test"}},2624:function(e,t,a){"use strict";var n,r;a.d(t,{L:function(){return n}}),(r=n||(n={})).none="none",r.console="console",r.message="message"},9153:function(e,t,a){"use strict";var n,r;a.d(t,{L:function(){return n}}),(r=n||(n={})).primary="primary",r.dark="dark",r.danger="danger",r.green="green"},666:function(e,t,a){"use strict";a.d(t,{FH:function(){return n},M7:function(){return s},mI:function(){return o},px:function(){return r}});let n="https://historical-site-backend-18d1df54380f.herokuapp.com",r="token",s=!1,o=200},5474:function(e,t,a){"use strict";a.d(t,{cM:function(){return c},gw:function(){return o},rn:function(){return l},sG:function(){return i}});var n=a(2624),r=a(5326),s=a.n(r);let o=async e=>{await new Promise(t=>setTimeout(t,e))},c=(e,t)=>{switch(t){case n.L.none:break;case n.L.console:case n.L.message:console.log(e)}};function l(e){return e?s()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}let i=(async()=>{}).constructor},1576:function(e){e.exports={primary:"Button_primary__Nhi6i",danger:"Button_danger__214td",dark:"Button_dark__Djc0e"}},4209:function(e){e.exports={backgroundMask:"Modal_backgroundMask__9WqVi",buttonGroup:"Modal_buttonGroup__PS_fc"}}},function(e){e.O(0,[550,720,524,253,488,744],function(){return e(e.s=7270)}),_N_E=e.O()}]);