(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16],{9189:function(e,t,r){Promise.resolve().then(r.bind(r,2489))},2489:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return R}});var a=r(9268),o=r(5474),n=r(666),i=r(6653);async function s(){return await (0,o.gw)(2e3),{code:n.mI,message:"mock",data:[{id:1,caseName:"caseName",caseId:"caseId",description:"describe",operateTime:"operationTime",operator:"operator",reply:"reply",updateTime:"updateTime",uploadTime:"uploadTime",userId:"userId"}]}}async function c(){if(n.M7)return await s();let e=await fetch("".concat(n.FH,"/management/reports"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}async function l(){return await (0,o.gw)(2e3),{code:n.mI,message:"mock",data:{isSuccess:!0}}}async function d(e){if(n.M7)return await l();let t=await fetch("".concat(n.FH,"/management/report/").concat(e),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}async function p(){return await (0,o.gw)(2e3),{code:n.mI,message:"mock",data:{imageURLs:["https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*","https://img.freepik.com/free-photo/puppy-that-is-walking-snow_1340-37228.jpg","https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*","https://img.freepik.com/free-photo/puppy-that-is-walking-snow_1340-37228.jpg","https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*","https://img.freepik.com/free-photo/puppy-that-is-walking-snow_1340-37228.jpg"],description:"mock",replies:[{reply:"mock",operateTime:"mock",operator:"mock"},{reply:"mock",operateTime:"mock",operator:"mock"},{reply:"mock",operateTime:"mock",operator:"mock"},{reply:"mock",operateTime:"mock",operator:"mock"}]}}}async function m(e,t){if(n.M7)return await p();let r=await fetch("".concat(n.FH,"/management/report/detail"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())},body:JSON.stringify({id:e,caseId:t})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return await r.json()}async function u(){return await (0,o.gw)(2e3),{code:n.mI,message:"mock",data:{isSuccess:!0}}}async function h(e,t){if(n.M7)return await u();let r=await fetch("".concat(n.FH,"/management/upload/reply"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())},body:JSON.stringify({id:e,reply:t})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));return await r.json()}var g=r(6831),f=r(7454),y=r(9748),w=r(1263),x=r(7007),k=r(4415),j=r(1904),_=r(6006),v=r(7909),I=r.n(v),T=r(6462),b=r(3368),C=r(7833),N=r.n(C),Z=r(8683),S=r.n(Z);function E(e){let{className:t,account:r,time:n,children:i}=e;return(0,a.jsxs)("div",{className:S()(N().comment,t),children:[(0,a.jsxs)("div",{className:N().head,children:[(0,a.jsx)("p",{children:r}),(0,a.jsx)("p",{children:n&&(0,o.rn)(n)})]}),(0,a.jsx)("p",{children:i})]})}var z=r(9153),U=r(158);let L=Number(I().imageWidth),P=Number(I().imageHeight),A=(0,_.memo)(()=>{var e,t;let r=(0,_.useCallback)(async()=>{try{let e=await c();if((null==e?void 0:e.code)!==n.mI)return U.Z.error(null==e?void 0:e.message),[];return e.data}catch(e){return[]}},[]),{loading:i,data:s,run:l}=(0,j.Q)(r,{manual:!1}),p=(0,_.useCallback)(async e=>{let t=await d(e);if((null==t?void 0:t.code)!==n.mI)throw U.Z.error(null==t?void 0:t.message),Error("deleteManagementReport error");U.Z.success("成功"),l()},[l]),[u,v]=(0,_.useState)(!1),[C,N]=(0,_.useState)(),[Z,S]=(0,_.useState)(""),{loading:A,data:R,run:M,reset:D}=(0,j.Q)(async(e,t)=>{try{let r=await m(e,t);if((null==r?void 0:r.code)!==n.mI){U.Z.error(null==r?void 0:r.message);return}let a={...r.data,imageUrlConfigs:r.data.imageURLs.map(e=>({id:(0,T.Z)(),url:e})),replyConfigs:r.data.replies.map(e=>{let{operator:t,operateTime:r,reply:a}=e;return{id:(0,T.Z)(),operator:t,operateTime:r,reply:a}})};return a}catch(e){}}),H=(0,_.useMemo)(()=>[{dataIndex:"id",title:"ID"},{dataIndex:"caseName",title:"回報古蹟名稱"},{dataIndex:"description",title:"回報描述"},{dataIndex:"userId",title:"上傳用戶帳號"},{dataIndex:"uploadTime",title:"上傳時間",render:e=>(0,o.rn)(e)},{dataIndex:"reply",title:"進度回覆"},{dataIndex:"operator",title:"操作者"},{dataIndex:"operateTime",title:"操作時間",render:e=>(0,o.rn)(e)},{title:"操作",render:(e,t)=>{let{id:r,caseId:o}=t;return(0,a.jsxs)("div",{className:I().operation,children:[(0,a.jsx)(g.Z,{looks:z.L.primary,onClick:()=>{v(!0),N(r),S(o),M(r,o)},children:"回覆"}),(0,a.jsx)(g.Z,{looks:z.L.danger,onClick:()=>{x.Z.confirm({content:(0,a.jsx)("div",{children:(0,a.jsx)("p",{children:"是否確認刪除？"})}),onOk:async()=>{await p(r)},okButtonProps:{looks:z.L.danger}})},children:"刪除"})]})}}],[p,M]),[F,O]=(0,_.useState)(""),{loading:Q,run:B}=(0,j.Q)(async()=>{if(F&&C)try{let e=await h(C,F);if((null==e?void 0:e.code)!==n.mI)throw U.Z.error(null==e?void 0:e.message),Error("postManagementUploadReply error");U.Z.success("成功"),O(""),M(C,Z),l()}catch(e){}}),[V,W]=(0,_.useState)(!1),[q,J]=(0,_.useState)("");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{columns:H,dataSource:s,loading:i}),(0,a.jsx)(x.Z,{open:u,width:440,onClose:()=>{v(!1),N(void 0),S(""),D()},children:(0,a.jsx)(b.Z,{spinning:A,children:(0,a.jsxs)("div",{className:I().reportModalContent,children:[(0,a.jsx)("p",{className:I().title,children:"回報圖片"}),(0,a.jsx)("div",{className:I().imageArea,children:null==R?void 0:null===(e=R.imageUrlConfigs)||void 0===e?void 0:e.map(e=>{let{id:t,url:r}=e;return(0,a.jsx)("div",{className:I().image,onClick:()=>{W(!0),J(r)},children:(0,a.jsx)(f.Z,{src:r,width:L,height:P,alt:"回報圖片"})},t)})}),(0,a.jsx)("p",{className:I().title,children:"回報描述"}),(null==R?void 0:R.description)&&(0,a.jsx)("p",{className:I().describe,children:R.description}),(0,a.jsx)("div",{className:I().comments,children:null==R?void 0:null===(t=R.replyConfigs)||void 0===t?void 0:t.map(e=>{let{id:t,operator:r,operateTime:o,reply:n}=e;return(0,a.jsx)(E,{time:o,account:r,children:n},t)})}),(0,a.jsx)(y.Z,{onSubmit:B,children:(0,a.jsxs)("div",{className:I().replyArea,children:[(0,a.jsx)(w.Z,{value:F,onChange:O,disabled:Q,onKeyDown:e=>{"Enter"===e.key&&""===F&&e.preventDefault()}}),(0,a.jsx)(g.Z,{type:"submit",loading:Q,looks:z.L.dark,children:"回覆"})]})})]})})}),(0,a.jsx)(x.Z,{open:V,onClose:()=>{W(!1),J("")},children:(0,a.jsx)(f.Z,{src:q,width:200,height:200,alt:"圖片"})})]})});A.displayName="RestorationPage";var R=A},7454:function(e,t,r){"use strict";var a=r(9268),o=r(6394),n=r.n(o),i=r(6006),s=r(8582);let c=(0,i.memo)((0,i.forwardRef)((e,t)=>{let{src:r,...o}=e;return(0,a.jsx)(n(),{...o,ref:t,unoptimized:!0,src:"string"==typeof r?(0,s.A0)(r):r})}));c.displayName="CustomImage",t.Z=c},9748:function(e,t,r){"use strict";r.d(t,{S:function(){return a}});var a,o=r(9268),n=r(6006),i=r(9924),s=r.n(i),c=r(8683),l=r.n(c),d=r(5474),p=r(2624);(a||(a={})).horizontal="horizontal";let m=(0,n.memo)(e=>{let{layout:t,onSubmit:r,children:i}=e,[c,m]=(0,n.useState)(!1);return(0,o.jsx)("form",{className:l()({[s().horizontal]:t===a.horizontal}),onSubmit:async e=>{if(e.preventDefault(),!c&&r){m(!0);try{r instanceof d.sG?await r():r()}catch(e){e instanceof Error?(0,d.cM)(e.message,p.L.console):(0,d.cM)(e,p.L.console)}finally{m(!1)}}},children:i})});m.displayName="Form",t.Z=m},7613:function(e){"use strict";e.exports={output:"export",basePath:"/historic-site-portal-demo-test"}},8582:function(e,t,r){"use strict";r.d(t,{$x:function(){return c},A0:function(){return d},Qv:function(){return l},_b:function(){return p},qz:function(){return s}});var a=r(7613),o=r.n(a),n=r(3034),i=r(6008);let s="redirect",c="/member",l="/login";function d(e){return e.startsWith("/")&&o().basePath?"".concat(o().basePath).concat(e):e}function p(e,t){(0,i.redirect)("".concat(l).concat(e===d("/")?"":"?".concat(s,"=").concat(encodeURIComponent("".concat(e,"?").concat(t.toString())))),n.RedirectType.replace)}},7833:function(e){e.exports={comment:"Comment_comment__58lVE",head:"Comment_head__Io4E1"}},7909:function(e){e.exports={imageWidth:"60",imageHeight:"60",operation:"page_operation__PBqQk",reportModalContent:"page_reportModalContent__Vz33w",title:"page_title__LbX8Q",imageArea:"page_imageArea__kDQsI",image:"page_image__U9lRb",describe:"page_describe__3o8KA",comments:"page_comments__kR8Jq",replyArea:"page_replyArea__PzWPk"}},9924:function(e){e.exports={horizontal:"Form_horizontal___Dh6K"}},6462:function(e,t,r){"use strict";let a;r.d(t,{Z:function(){return l}});let o="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var n={randomUUID:o};let i=new Uint8Array(16);function s(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}let c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));var l=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();e=e||{};let a=e.random||(e.rng||s)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase()}(a)}}},function(e){e.O(0,[550,263,320,253,488,744],function(){return e(e.s=9189)}),_N_E=e.O()}]);